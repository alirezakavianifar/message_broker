<!DOCTYPE html><html><head>
<title>DEPLOYMENT_AND_RUNNING_GUIDE.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/*

Arduino® Light Theme - Stefania Mellai <s.mellai@arduino.cc>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #FFFFFF;
}

.hljs,
.hljs-subst {
  color: #434f54;
}

.hljs-keyword,
.hljs-attribute,
.hljs-selector-tag,
.hljs-doctag,
.hljs-name {
  color: #00979D;
}

.hljs-built_in,
.hljs-literal,
.hljs-bullet,
.hljs-code,
.hljs-addition {
  color: #D35400;
}

.hljs-regexp,
.hljs-symbol,
.hljs-variable,
.hljs-template-variable,
.hljs-link,
.hljs-selector-attr,
.hljs-selector-pseudo {
  color: #00979D;
}

.hljs-type,
.hljs-string,
.hljs-selector-id,
.hljs-selector-class,
.hljs-quote,
.hljs-template-tag,
.hljs-deletion {
  color: #005C5F;
}

.hljs-title,
.hljs-section {
  color: #880000;
  font-weight: bold;
}

.hljs-comment {
  color: rgba(149,165,166,.8);
}

.hljs-meta-keyword {
  color: #728E00;
}

.hljs-meta {
  color: #434f54;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

.hljs-function {
  color: #728E00;
}

.hljs-number {
  color: #8A7B52;  
}

</style>

<style>
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family:   "HelveticaNeue-Light", sans-serif, "宋体","Segoe WPC", "Segoe UI", "SFUIText-Light","Droid Sans Fallback";
	font-size: 18px;
	padding: 0 12px;
	line-height: 1.6;
	word-wrap: break-word;
	color: #333333;
}

.content-wrapper{
	max-width: 860px;
    margin: 0 auto;
    padding: 0 30px;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}


body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	color: #4080D0;
	text-decoration: none;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom: 1px solid #eee;
}


h2{
	padding-bottom: .3em;
    font-size: 2em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

h3{
	font-size: 1.75em;
    line-height: 1.225;
}

h1, h2, h3 {
	font-weight: bold;
}

h1 code,
h2 code,
h3 code,
h4 code,
h5 code,
h6 code {
	font-size: inherit;
	line-height: auto;
}

a:hover {
	color: #4080D0;
	text-decoration: underline;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left: 5px solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 14px;
	line-height: 19px;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

.mac code {
	font-size: 12px;
	line-height: 18px;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

/** Theming */

.vscode-light,
.vscode-light pre code {
	color: rgb(30, 30, 30);
}

.vscode-dark,
.vscode-dark pre code {
	color: #DDD;
}

.vscode-high-contrast,
.vscode-high-contrast pre code {
	color: white;
}

.vscode-light code {
	color: #A31515;
}

.vscode-dark code {
	color: #D7BA7D;
}

.vscode-light pre:not(.hljs),
.vscode-light code > div {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre:not(.hljs),
.vscode-dark code > div {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre:not(.hljs),
.vscode-high-contrast code > div {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

.vscode-light blockquote,
.vscode-dark blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.vscode-high-contrast blockquote {
	background: transparent;
	border-color: #fff;
}
</style>

<style>
pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

.table-of-contents li{
	list-style-type: initial;
}
</style>

<style>
@font-face{font-family:KaTeX_AMS;font-style:normal;font-weight:400;src:url(fonts/KaTeX_AMS-Regular.woff2) format("woff2"),url(fonts/KaTeX_AMS-Regular.woff) format("woff"),url(fonts/KaTeX_AMS-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Caligraphic-Bold.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Bold.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Caligraphic-Regular.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Regular.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Fraktur-Bold.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Bold.woff) format("woff"),url(fonts/KaTeX_Fraktur-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Fraktur-Regular.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Regular.woff) format("woff"),url(fonts/KaTeX_Fraktur-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Main-Bold.woff2) format("woff2"),url(fonts/KaTeX_Main-Bold.woff) format("woff"),url(fonts/KaTeX_Main-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Main-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Main-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Main-Italic.woff2) format("woff2"),url(fonts/KaTeX_Main-Italic.woff) format("woff"),url(fonts/KaTeX_Main-Italic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Main-Regular.woff2) format("woff2"),url(fonts/KaTeX_Main-Regular.woff) format("woff"),url(fonts/KaTeX_Main-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Math-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Math-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Math-Italic.woff2) format("woff2"),url(fonts/KaTeX_Math-Italic.woff) format("woff"),url(fonts/KaTeX_Math-Italic.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:normal;font-weight:700;src:url(fonts/KaTeX_SansSerif-Bold.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Bold.woff) format("woff"),url(fonts/KaTeX_SansSerif-Bold.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:italic;font-weight:400;src:url(fonts/KaTeX_SansSerif-Italic.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Italic.woff) format("woff"),url(fonts/KaTeX_SansSerif-Italic.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:normal;font-weight:400;src:url(fonts/KaTeX_SansSerif-Regular.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Regular.woff) format("woff"),url(fonts/KaTeX_SansSerif-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Script;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Script-Regular.woff2) format("woff2"),url(fonts/KaTeX_Script-Regular.woff) format("woff"),url(fonts/KaTeX_Script-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size1;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size1-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size1-Regular.woff) format("woff"),url(fonts/KaTeX_Size1-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size2;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size2-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size2-Regular.woff) format("woff"),url(fonts/KaTeX_Size2-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size3;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size3-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size3-Regular.woff) format("woff"),url(fonts/KaTeX_Size3-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size4;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size4-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size4-Regular.woff) format("woff"),url(fonts/KaTeX_Size4-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Typewriter;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Typewriter-Regular.woff2) format("woff2"),url(fonts/KaTeX_Typewriter-Regular.woff) format("woff"),url(fonts/KaTeX_Typewriter-Regular.ttf) format("truetype")}.katex{text-rendering:auto;font:normal 1.21em KaTeX_Main,Times New Roman,serif;line-height:1.2;text-indent:0}.katex *{-ms-high-contrast-adjust:none!important;border-color:currentColor}.katex .katex-version:after{content:"0.16.2"}.katex .katex-mathml{clip:rect(1px,1px,1px,1px);border:0;height:1px;overflow:hidden;padding:0;position:absolute;width:1px}.katex .katex-html>.newline{display:block}.katex .base{position:relative;white-space:nowrap;width:-webkit-min-content;width:-moz-min-content;width:min-content}.katex .base,.katex .strut{display:inline-block}.katex .textbf{font-weight:700}.katex .textit{font-style:italic}.katex .textrm{font-family:KaTeX_Main}.katex .textsf{font-family:KaTeX_SansSerif}.katex .texttt{font-family:KaTeX_Typewriter}.katex .mathnormal{font-family:KaTeX_Math;font-style:italic}.katex .mathit{font-family:KaTeX_Main;font-style:italic}.katex .mathrm{font-style:normal}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .boldsymbol{font-family:KaTeX_Math;font-style:italic;font-weight:700}.katex .amsrm,.katex .mathbb,.katex .textbb{font-family:KaTeX_AMS}.katex .mathcal{font-family:KaTeX_Caligraphic}.katex .mathfrak,.katex .textfrak{font-family:KaTeX_Fraktur}.katex .mathtt{font-family:KaTeX_Typewriter}.katex .mathscr,.katex .textscr{font-family:KaTeX_Script}.katex .mathsf,.katex .textsf{font-family:KaTeX_SansSerif}.katex .mathboldsf,.katex .textboldsf{font-family:KaTeX_SansSerif;font-weight:700}.katex .mathitsf,.katex .textitsf{font-family:KaTeX_SansSerif;font-style:italic}.katex .mainrm{font-family:KaTeX_Main;font-style:normal}.katex .vlist-t{border-collapse:collapse;display:inline-table;table-layout:fixed}.katex .vlist-r{display:table-row}.katex .vlist{display:table-cell;position:relative;vertical-align:bottom}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist>span>.pstrut{overflow:hidden;width:0}.katex .vlist-t2{margin-right:-2px}.katex .vlist-s{display:table-cell;font-size:1px;min-width:2px;vertical-align:bottom;width:2px}.katex .vbox{align-items:baseline;display:inline-flex;flex-direction:column}.katex .hbox{width:100%}.katex .hbox,.katex .thinbox{display:inline-flex;flex-direction:row}.katex .thinbox{max-width:0;width:0}.katex .msupsub{text-align:left}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .hdashline,.katex .hline,.katex .mfrac .frac-line,.katex .overline .overline-line,.katex .rule,.katex .underline .underline-line{min-height:1px}.katex .mspace{display:inline-block}.katex .clap,.katex .llap,.katex .rlap{position:relative;width:0}.katex .clap>.inner,.katex .llap>.inner,.katex .rlap>.inner{position:absolute}.katex .clap>.fix,.katex .llap>.fix,.katex .rlap>.fix{display:inline-block}.katex .llap>.inner{right:0}.katex .clap>.inner,.katex .rlap>.inner{left:0}.katex .clap>.inner>span{margin-left:-50%;margin-right:50%}.katex .rule{border:0 solid;display:inline-block;position:relative}.katex .hline,.katex .overline .overline-line,.katex .underline .underline-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .hdashline{border-bottom-style:dashed;display:inline-block;width:100%}.katex .sqrt>.root{margin-left:.27777778em;margin-right:-.55555556em}.katex .fontsize-ensurer.reset-size1.size1,.katex .sizing.reset-size1.size1{font-size:1em}.katex .fontsize-ensurer.reset-size1.size2,.katex .sizing.reset-size1.size2{font-size:1.2em}.katex .fontsize-ensurer.reset-size1.size3,.katex .sizing.reset-size1.size3{font-size:1.4em}.katex .fontsize-ensurer.reset-size1.size4,.katex .sizing.reset-size1.size4{font-size:1.6em}.katex .fontsize-ensurer.reset-size1.size5,.katex .sizing.reset-size1.size5{font-size:1.8em}.katex .fontsize-ensurer.reset-size1.size6,.katex .sizing.reset-size1.size6{font-size:2em}.katex .fontsize-ensurer.reset-size1.size7,.katex .sizing.reset-size1.size7{font-size:2.4em}.katex .fontsize-ensurer.reset-size1.size8,.katex .sizing.reset-size1.size8{font-size:2.88em}.katex .fontsize-ensurer.reset-size1.size9,.katex .sizing.reset-size1.size9{font-size:3.456em}.katex .fontsize-ensurer.reset-size1.size10,.katex .sizing.reset-size1.size10{font-size:4.148em}.katex .fontsize-ensurer.reset-size1.size11,.katex .sizing.reset-size1.size11{font-size:4.976em}.katex .fontsize-ensurer.reset-size2.size1,.katex .sizing.reset-size2.size1{font-size:.83333333em}.katex .fontsize-ensurer.reset-size2.size2,.katex .sizing.reset-size2.size2{font-size:1em}.katex .fontsize-ensurer.reset-size2.size3,.katex .sizing.reset-size2.size3{font-size:1.16666667em}.katex .fontsize-ensurer.reset-size2.size4,.katex .sizing.reset-size2.size4{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size2.size5,.katex .sizing.reset-size2.size5{font-size:1.5em}.katex .fontsize-ensurer.reset-size2.size6,.katex .sizing.reset-size2.size6{font-size:1.66666667em}.katex .fontsize-ensurer.reset-size2.size7,.katex .sizing.reset-size2.size7{font-size:2em}.katex .fontsize-ensurer.reset-size2.size8,.katex .sizing.reset-size2.size8{font-size:2.4em}.katex .fontsize-ensurer.reset-size2.size9,.katex .sizing.reset-size2.size9{font-size:2.88em}.katex .fontsize-ensurer.reset-size2.size10,.katex .sizing.reset-size2.size10{font-size:3.45666667em}.katex .fontsize-ensurer.reset-size2.size11,.katex .sizing.reset-size2.size11{font-size:4.14666667em}.katex .fontsize-ensurer.reset-size3.size1,.katex .sizing.reset-size3.size1{font-size:.71428571em}.katex .fontsize-ensurer.reset-size3.size2,.katex .sizing.reset-size3.size2{font-size:.85714286em}.katex .fontsize-ensurer.reset-size3.size3,.katex .sizing.reset-size3.size3{font-size:1em}.katex .fontsize-ensurer.reset-size3.size4,.katex .sizing.reset-size3.size4{font-size:1.14285714em}.katex .fontsize-ensurer.reset-size3.size5,.katex .sizing.reset-size3.size5{font-size:1.28571429em}.katex .fontsize-ensurer.reset-size3.size6,.katex .sizing.reset-size3.size6{font-size:1.42857143em}.katex .fontsize-ensurer.reset-size3.size7,.katex .sizing.reset-size3.size7{font-size:1.71428571em}.katex .fontsize-ensurer.reset-size3.size8,.katex .sizing.reset-size3.size8{font-size:2.05714286em}.katex .fontsize-ensurer.reset-size3.size9,.katex .sizing.reset-size3.size9{font-size:2.46857143em}.katex .fontsize-ensurer.reset-size3.size10,.katex .sizing.reset-size3.size10{font-size:2.96285714em}.katex .fontsize-ensurer.reset-size3.size11,.katex .sizing.reset-size3.size11{font-size:3.55428571em}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.625em}.katex .fontsize-ensurer.reset-size4.size2,.katex .sizing.reset-size4.size2{font-size:.75em}.katex .fontsize-ensurer.reset-size4.size3,.katex .sizing.reset-size4.size3{font-size:.875em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.125em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.25em}.katex .fontsize-ensurer.reset-size4.size7,.katex .sizing.reset-size4.size7{font-size:1.5em}.katex .fontsize-ensurer.reset-size4.size8,.katex .sizing.reset-size4.size8{font-size:1.8em}.katex .fontsize-ensurer.reset-size4.size9,.katex .sizing.reset-size4.size9{font-size:2.16em}.katex .fontsize-ensurer.reset-size4.size10,.katex .sizing.reset-size4.size10{font-size:2.5925em}.katex .fontsize-ensurer.reset-size4.size11,.katex .sizing.reset-size4.size11{font-size:3.11em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.55555556em}.katex .fontsize-ensurer.reset-size5.size2,.katex .sizing.reset-size5.size2{font-size:.66666667em}.katex .fontsize-ensurer.reset-size5.size3,.katex .sizing.reset-size5.size3{font-size:.77777778em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.88888889em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.11111111em}.katex .fontsize-ensurer.reset-size5.size7,.katex .sizing.reset-size5.size7{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size5.size8,.katex .sizing.reset-size5.size8{font-size:1.6em}.katex .fontsize-ensurer.reset-size5.size9,.katex .sizing.reset-size5.size9{font-size:1.92em}.katex .fontsize-ensurer.reset-size5.size10,.katex .sizing.reset-size5.size10{font-size:2.30444444em}.katex .fontsize-ensurer.reset-size5.size11,.katex .sizing.reset-size5.size11{font-size:2.76444444em}.katex .fontsize-ensurer.reset-size6.size1,.katex .sizing.reset-size6.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size6.size2,.katex .sizing.reset-size6.size2{font-size:.6em}.katex .fontsize-ensurer.reset-size6.size3,.katex .sizing.reset-size6.size3{font-size:.7em}.katex .fontsize-ensurer.reset-size6.size4,.katex .sizing.reset-size6.size4{font-size:.8em}.katex .fontsize-ensurer.reset-size6.size5,.katex .sizing.reset-size6.size5{font-size:.9em}.katex .fontsize-ensurer.reset-size6.size6,.katex .sizing.reset-size6.size6{font-size:1em}.katex .fontsize-ensurer.reset-size6.size7,.katex .sizing.reset-size6.size7{font-size:1.2em}.katex .fontsize-ensurer.reset-size6.size8,.katex .sizing.reset-size6.size8{font-size:1.44em}.katex .fontsize-ensurer.reset-size6.size9,.katex .sizing.reset-size6.size9{font-size:1.728em}.katex .fontsize-ensurer.reset-size6.size10,.katex .sizing.reset-size6.size10{font-size:2.074em}.katex .fontsize-ensurer.reset-size6.size11,.katex .sizing.reset-size6.size11{font-size:2.488em}.katex .fontsize-ensurer.reset-size7.size1,.katex .sizing.reset-size7.size1{font-size:.41666667em}.katex .fontsize-ensurer.reset-size7.size2,.katex .sizing.reset-size7.size2{font-size:.5em}.katex .fontsize-ensurer.reset-size7.size3,.katex .sizing.reset-size7.size3{font-size:.58333333em}.katex .fontsize-ensurer.reset-size7.size4,.katex .sizing.reset-size7.size4{font-size:.66666667em}.katex .fontsize-ensurer.reset-size7.size5,.katex .sizing.reset-size7.size5{font-size:.75em}.katex .fontsize-ensurer.reset-size7.size6,.katex .sizing.reset-size7.size6{font-size:.83333333em}.katex .fontsize-ensurer.reset-size7.size7,.katex .sizing.reset-size7.size7{font-size:1em}.katex .fontsize-ensurer.reset-size7.size8,.katex .sizing.reset-size7.size8{font-size:1.2em}.katex .fontsize-ensurer.reset-size7.size9,.katex .sizing.reset-size7.size9{font-size:1.44em}.katex .fontsize-ensurer.reset-size7.size10,.katex .sizing.reset-size7.size10{font-size:1.72833333em}.katex .fontsize-ensurer.reset-size7.size11,.katex .sizing.reset-size7.size11{font-size:2.07333333em}.katex .fontsize-ensurer.reset-size8.size1,.katex .sizing.reset-size8.size1{font-size:.34722222em}.katex .fontsize-ensurer.reset-size8.size2,.katex .sizing.reset-size8.size2{font-size:.41666667em}.katex .fontsize-ensurer.reset-size8.size3,.katex .sizing.reset-size8.size3{font-size:.48611111em}.katex .fontsize-ensurer.reset-size8.size4,.katex .sizing.reset-size8.size4{font-size:.55555556em}.katex .fontsize-ensurer.reset-size8.size5,.katex .sizing.reset-size8.size5{font-size:.625em}.katex .fontsize-ensurer.reset-size8.size6,.katex .sizing.reset-size8.size6{font-size:.69444444em}.katex .fontsize-ensurer.reset-size8.size7,.katex .sizing.reset-size8.size7{font-size:.83333333em}.katex .fontsize-ensurer.reset-size8.size8,.katex .sizing.reset-size8.size8{font-size:1em}.katex .fontsize-ensurer.reset-size8.size9,.katex .sizing.reset-size8.size9{font-size:1.2em}.katex .fontsize-ensurer.reset-size8.size10,.katex .sizing.reset-size8.size10{font-size:1.44027778em}.katex .fontsize-ensurer.reset-size8.size11,.katex .sizing.reset-size8.size11{font-size:1.72777778em}.katex .fontsize-ensurer.reset-size9.size1,.katex .sizing.reset-size9.size1{font-size:.28935185em}.katex .fontsize-ensurer.reset-size9.size2,.katex .sizing.reset-size9.size2{font-size:.34722222em}.katex .fontsize-ensurer.reset-size9.size3,.katex .sizing.reset-size9.size3{font-size:.40509259em}.katex .fontsize-ensurer.reset-size9.size4,.katex .sizing.reset-size9.size4{font-size:.46296296em}.katex .fontsize-ensurer.reset-size9.size5,.katex .sizing.reset-size9.size5{font-size:.52083333em}.katex .fontsize-ensurer.reset-size9.size6,.katex .sizing.reset-size9.size6{font-size:.5787037em}.katex .fontsize-ensurer.reset-size9.size7,.katex .sizing.reset-size9.size7{font-size:.69444444em}.katex .fontsize-ensurer.reset-size9.size8,.katex .sizing.reset-size9.size8{font-size:.83333333em}.katex .fontsize-ensurer.reset-size9.size9,.katex .sizing.reset-size9.size9{font-size:1em}.katex .fontsize-ensurer.reset-size9.size10,.katex .sizing.reset-size9.size10{font-size:1.20023148em}.katex .fontsize-ensurer.reset-size9.size11,.katex .sizing.reset-size9.size11{font-size:1.43981481em}.katex .fontsize-ensurer.reset-size10.size1,.katex .sizing.reset-size10.size1{font-size:.24108004em}.katex .fontsize-ensurer.reset-size10.size2,.katex .sizing.reset-size10.size2{font-size:.28929605em}.katex .fontsize-ensurer.reset-size10.size3,.katex .sizing.reset-size10.size3{font-size:.33751205em}.katex .fontsize-ensurer.reset-size10.size4,.katex .sizing.reset-size10.size4{font-size:.38572806em}.katex .fontsize-ensurer.reset-size10.size5,.katex .sizing.reset-size10.size5{font-size:.43394407em}.katex .fontsize-ensurer.reset-size10.size6,.katex .sizing.reset-size10.size6{font-size:.48216008em}.katex .fontsize-ensurer.reset-size10.size7,.katex .sizing.reset-size10.size7{font-size:.57859209em}.katex .fontsize-ensurer.reset-size10.size8,.katex .sizing.reset-size10.size8{font-size:.69431051em}.katex .fontsize-ensurer.reset-size10.size9,.katex .sizing.reset-size10.size9{font-size:.83317261em}.katex .fontsize-ensurer.reset-size10.size10,.katex .sizing.reset-size10.size10{font-size:1em}.katex .fontsize-ensurer.reset-size10.size11,.katex .sizing.reset-size10.size11{font-size:1.19961427em}.katex .fontsize-ensurer.reset-size11.size1,.katex .sizing.reset-size11.size1{font-size:.20096463em}.katex .fontsize-ensurer.reset-size11.size2,.katex .sizing.reset-size11.size2{font-size:.24115756em}.katex .fontsize-ensurer.reset-size11.size3,.katex .sizing.reset-size11.size3{font-size:.28135048em}.katex .fontsize-ensurer.reset-size11.size4,.katex .sizing.reset-size11.size4{font-size:.32154341em}.katex .fontsize-ensurer.reset-size11.size5,.katex .sizing.reset-size11.size5{font-size:.36173633em}.katex .fontsize-ensurer.reset-size11.size6,.katex .sizing.reset-size11.size6{font-size:.40192926em}.katex .fontsize-ensurer.reset-size11.size7,.katex .sizing.reset-size11.size7{font-size:.48231511em}.katex .fontsize-ensurer.reset-size11.size8,.katex .sizing.reset-size11.size8{font-size:.57877814em}.katex .fontsize-ensurer.reset-size11.size9,.katex .sizing.reset-size11.size9{font-size:.69453376em}.katex .fontsize-ensurer.reset-size11.size10,.katex .sizing.reset-size11.size10{font-size:.83360129em}.katex .fontsize-ensurer.reset-size11.size11,.katex .sizing.reset-size11.size11{font-size:1em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.size2{font-family:KaTeX_Size2}.katex .delimsizing.size3{font-family:KaTeX_Size3}.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .delimsizing.mult .delim-size1>span{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .delimcenter,.katex .op-symbol{position:relative}.katex .op-symbol.small-op{font-family:KaTeX_Size1}.katex .op-symbol.large-op{font-family:KaTeX_Size2}.katex .accent>.vlist-t,.katex .op-limits>.vlist-t{text-align:center}.katex .accent .accent-body{position:relative}.katex .accent .accent-body:not(.accent-full){width:0}.katex .overlay{display:block}.katex .mtable .vertical-separator{display:inline-block;min-width:1px}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-c>.vlist-t{text-align:center}.katex .mtable .col-align-l>.vlist-t{text-align:left}.katex .mtable .col-align-r>.vlist-t{text-align:right}.katex .svg-align{text-align:left}.katex svg{fill:currentColor;stroke:currentColor;fill-rule:nonzero;fill-opacity:1;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;display:block;height:inherit;position:absolute;width:100%}.katex svg path{stroke:none}.katex img{border-style:none;max-height:none;max-width:none;min-height:0;min-width:0}.katex .stretchy{display:block;overflow:hidden;position:relative;width:100%}.katex .stretchy:after,.katex .stretchy:before{content:""}.katex .hide-tail{overflow:hidden;position:relative;width:100%}.katex .halfarrow-left{left:0;overflow:hidden;position:absolute;width:50.2%}.katex .halfarrow-right{overflow:hidden;position:absolute;right:0;width:50.2%}.katex .brace-left{left:0;overflow:hidden;position:absolute;width:25.1%}.katex .brace-center{left:25%;overflow:hidden;position:absolute;width:50%}.katex .brace-right{overflow:hidden;position:absolute;right:0;width:25.1%}.katex .x-arrow-pad{padding:0 .5em}.katex .cd-arrow-pad{padding:0 .55556em 0 .27778em}.katex .mover,.katex .munder,.katex .x-arrow{text-align:center}.katex .boxpad{padding:0 .3em}.katex .fbox,.katex .fcolorbox{border:.04em solid;box-sizing:border-box}.katex .cancel-pad{padding:0 .2em}.katex .cancel-lap{margin-left:-.2em;margin-right:-.2em}.katex .sout{border-bottom-style:solid;border-bottom-width:.08em}.katex .angl{border-right:.049em solid;border-top:.049em solid;box-sizing:border-box;margin-right:.03889em}.katex .anglpad{padding:0 .03889em}.katex .eqn-num:before{content:"(" counter(katexEqnNo) ")";counter-increment:katexEqnNo}.katex .mml-eqn-num:before{content:"(" counter(mmlEqnNo) ")";counter-increment:mmlEqnNo}.katex .mtr-glue{width:50%}.katex .cd-vert-arrow{display:inline-block;position:relative}.katex .cd-label-left{display:inline-block;position:absolute;right:calc(50% + .3em);text-align:left}.katex .cd-label-right{display:inline-block;left:calc(50% + .3em);position:absolute;text-align:right}.katex-display{display:block;margin:1em 0;text-align:center}.katex-display>.katex{display:block;text-align:center;white-space:nowrap}.katex-display>.katex>.katex-html{display:block;position:relative}.katex-display>.katex>.katex-html>.tag{position:absolute;right:0}.katex-display.leqno>.katex>.katex-html>.tag{left:0;right:auto}.katex-display.fleqn>.katex{padding-left:2em;text-align:left}body{counter-reset:katexEqnNo mmlEqnNo}

</style>

</head>
<body>
    <div class="content-wrapper">
        <h1 id="message-broker-system---complete-deployment-and-running-guide" tabindex="-1">Message Broker System - Complete Deployment and Running Guide</h1>
<p><strong>Version</strong>: 2.0.0<br>
<strong>Last Updated</strong>: November 2025<br>
<strong>Platform</strong>: Linux (Ubuntu/Debian/CentOS/RHEL)<br>
<strong>Status</strong>: Production Ready</p>
<hr>
<h2 id="table-of-contents" tabindex="-1">Table of Contents</h2>
<ol>
<li><a href="#system-overview">System Overview</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#quick-start---automated-deployment">Quick Start - Automated Deployment</a></li>
<li><a href="#manual-deployment">Manual Deployment</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#service-management">Service Management</a></li>
<li><a href="#verification-and-testing">Verification and Testing</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#post-deployment-tasks">Post-Deployment Tasks</a></li>
<li><a href="#maintenance-and-updates">Maintenance and Updates</a></li>
</ol>
<hr>
<h2 id="system-overview" tabindex="-1">System Overview</h2>
<h3 id="architecture" tabindex="-1">Architecture</h3>
<pre class="hljs"><code><div>Client → Proxy (Port 8001) → Redis Queue → Worker → Main Server (Port 8000) → MySQL
                                                              ↓
                                                        Web Portal (Port 8080)
</div></code></pre>
<h3 id="components" tabindex="-1">Components</h3>
<ol>
<li>
<p><strong>Main Server</strong> (Port 8000)</p>
<ul>
<li>Central API and database service</li>
<li>Certificate Authority (CA) management</li>
<li>User authentication and authorization</li>
<li>Message persistence</li>
<li>HTTPS with mutual TLS</li>
</ul>
</li>
<li>
<p><strong>Proxy Server</strong> (Port 8001)</p>
<ul>
<li>Client-facing message ingestion endpoint</li>
<li>Message validation and queuing</li>
<li>Mutual TLS authentication</li>
<li>Load balancing and rate limiting</li>
</ul>
</li>
<li>
<p><strong>Worker Service</strong></p>
<ul>
<li>Consumes messages from Redis queue</li>
<li>Processes and delivers messages</li>
<li>Retry logic with exponential backoff</li>
<li>Error handling and dead letter queue</li>
</ul>
</li>
<li>
<p><strong>Web Portal</strong> (Port 8080)</p>
<ul>
<li>Web-based user interface</li>
<li>Message viewing and management</li>
<li>User administration</li>
<li>System statistics and monitoring</li>
</ul>
</li>
</ol>
<h3 id="network-ports" tabindex="-1">Network Ports</h3>
<table>
<thead>
<tr>
<th>Port</th>
<th>Service</th>
<th>Protocol</th>
<th>Access</th>
</tr>
</thead>
<tbody>
<tr>
<td>8000</td>
<td>Main Server</td>
<td>HTTPS</td>
<td>Internal/External</td>
</tr>
<tr>
<td>8001</td>
<td>Proxy Server</td>
<td>HTTPS (mTLS)</td>
<td>External</td>
</tr>
<tr>
<td>8080</td>
<td>Web Portal</td>
<td>HTTP</td>
<td>External</td>
</tr>
<tr>
<td>3306</td>
<td>MySQL</td>
<td>TCP</td>
<td>Internal</td>
</tr>
<tr>
<td>6379</td>
<td>Redis</td>
<td>TCP</td>
<td>Internal</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="prerequisites" tabindex="-1">Prerequisites</h2>
<h3 id="system-requirements" tabindex="-1">System Requirements</h3>
<p><strong>Minimum Requirements:</strong></p>
<ul>
<li><strong>OS</strong>: Ubuntu 20.04+, Debian 11+, CentOS 8+, RHEL 8+, or Rocky Linux 8+</li>
<li><strong>RAM</strong>: 2GB minimum (4GB recommended)</li>
<li><strong>Disk</strong>: 20GB free space</li>
<li><strong>CPU</strong>: 2 cores minimum (4 cores recommended)</li>
<li><strong>Network</strong>: Internet connection for package installation</li>
</ul>
<p><strong>Recommended for Production:</strong></p>
<ul>
<li><strong>RAM</strong>: 8GB+</li>
<li><strong>Disk</strong>: 50GB+ SSD</li>
<li><strong>CPU</strong>: 4+ cores</li>
<li><strong>Network</strong>: 100 Mbps+</li>
</ul>
<h3 id="required-software" tabindex="-1">Required Software</h3>
<table>
<thead>
<tr>
<th>Software</th>
<th>Version</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Python</td>
<td>3.11+</td>
<td>Application runtime</td>
</tr>
<tr>
<td>MySQL/MariaDB</td>
<td>8.0+ / 10.5+</td>
<td>Database server</td>
</tr>
<tr>
<td>Redis</td>
<td>6.0+</td>
<td>Message queue</td>
</tr>
<tr>
<td>OpenSSL</td>
<td>1.1.1+</td>
<td>Certificate generation</td>
</tr>
<tr>
<td>systemd</td>
<td>Latest</td>
<td>Service management</td>
</tr>
<tr>
<td>Git</td>
<td>Latest</td>
<td>Code repository</td>
</tr>
</tbody>
</table>
<h3 id="deployment-machine-requirements-(windows)" tabindex="-1">Deployment Machine Requirements (Windows)</h3>
<p>If deploying from Windows:</p>
<ul>
<li><strong>PowerShell</strong> 5.1 or higher</li>
<li><strong>OpenSSH Client</strong> (usually pre-installed on Windows 10/11)</li>
<li><strong>PuTTY</strong> (optional, for <code>plink</code> automatic password entry)</li>
<li><strong>WSL</strong> (optional, for <code>sshpass</code>)</li>
</ul>
<hr>
<h2 id="quick-start---automated-deployment" tabindex="-1">Quick Start - Automated Deployment</h2>
<p>The fastest way to deploy is using the automated PowerShell script.</p>
<h3 id="step-1%3A-prepare-deployment-machine-(windows)" tabindex="-1">Step 1: Prepare Deployment Machine (Windows)</h3>
<ol>
<li><strong>Install Prerequisites</strong> (if not already installed):</li>
</ol>
<pre class="hljs"><code><div><span class="hljs-comment"># Install OpenSSH Client</span>
<span class="hljs-built_in">Add-WindowsCapability</span> <span class="hljs-literal">-Online</span> <span class="hljs-literal">-Name</span> OpenSSH.Client~~~~<span class="hljs-number">0.0</span>.<span class="hljs-number">1.0</span>

<span class="hljs-comment"># Install PuTTY (optional, for automatic password entry)</span>
<span class="hljs-comment"># Download from: https://www.putty.org/</span>
</div></code></pre>
<ol start="2">
<li><strong>Verify Tools</strong>:</li>
</ol>
<pre class="hljs"><code><div><span class="hljs-comment"># Check prerequisites</span>
.\check_prerequisites.ps1
</div></code></pre>
<h3 id="step-2%3A-configure-server-access" tabindex="-1">Step 2: Configure Server Access</h3>
<p>Ensure you have:</p>
<ul>
<li>Server IP address</li>
<li>SSH username (usually <code>root</code> or a user with sudo privileges)</li>
<li>SSH password or SSH key</li>
<li>SSH port (default: 22, or custom port)</li>
</ul>
<h3 id="step-3%3A-run-automated-deployment" tabindex="-1">Step 3: Run Automated Deployment</h3>
<p><strong>Option A: Using deploy_now.ps1 (Quick Deploy)</strong></p>
<p>Edit <code>deploy_now.ps1</code> and set your server credentials:</p>
<pre class="hljs"><code><div><span class="hljs-variable">$ServerIP</span> = <span class="hljs-string">"173.32.115.223"</span>
<span class="hljs-variable">$SSHPort</span> = <span class="hljs-number">2222</span>
<span class="hljs-variable">$Username</span> = <span class="hljs-string">"root"</span>
<span class="hljs-variable">$Password</span> = <span class="hljs-string">"YourPassword"</span>
</div></code></pre>
<p>Then run:</p>
<pre class="hljs"><code><div>.\deploy_now.ps1
</div></code></pre>
<p><strong>Option B: Using deploy_to_linux.ps1 (Full Control)</strong></p>
<pre class="hljs"><code><div>.\deploy_to_linux.ps1 `
    <span class="hljs-literal">-ServerIP</span> <span class="hljs-string">"173.32.115.223"</span> `
    <span class="hljs-literal">-Username</span> <span class="hljs-string">"root"</span> `
    <span class="hljs-literal">-Password</span> <span class="hljs-string">"YourPassword"</span> `
    <span class="hljs-literal">-SSHPort</span> <span class="hljs-number">2222</span> `
    <span class="hljs-literal">-RemotePath</span> <span class="hljs-string">"/opt/message_broker"</span>
</div></code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>-ServerIP</code>: Target server IP address (required)</li>
<li><code>-Username</code>: SSH username (required)</li>
<li><code>-Password</code>: SSH password (optional if using SSH key)</li>
<li><code>-SSHKey</code>: Path to SSH private key (optional)</li>
<li><code>-SSHPort</code>: SSH port (default: 2223)</li>
<li><code>-RemotePath</code>: Installation path on server (default: <code>/opt/message_broker</code>)</li>
<li><code>-SkipTransfer</code>: Skip file transfer if already deployed</li>
<li><code>-SkipServices</code>: Skip service installation</li>
</ul>
<p><strong>Important Notes:</strong></p>
<ul>
<li>The script uses <strong>hardcoded database password</strong>: <code>YourStrongPassword123!</code></li>
<li>The script uses <strong>hardcoded admin credentials</strong>: <code>admin@example.com</code> / <code>AdminPass123!</code></li>
<li><strong>Change these passwords after deployment</strong> for production use</li>
<li>Services are <strong>enabled</strong> but <strong>NOT started</strong> automatically - you must start them manually</li>
<li>The script supports automatic password entry via <code>plink</code> (PuTTY) or <code>sshpass</code> (WSL)</li>
</ul>
<h3 id="step-4%3A-what-the-script-does" tabindex="-1">Step 4: What the Script Does</h3>
<p>The automated deployment script performs the following steps in order:</p>
<ol>
<li>
<p>✅ <strong>File Transfer</strong>:</p>
<ul>
<li>Creates a compressed archive (tar.gz or zip) of project files</li>
<li>Transfers archive to <code>/tmp/</code> on remote server</li>
<li>Excludes: <code>venv</code>, <code>__pycache__</code>, <code>.git</code>, <code>logs</code>, <code>.env</code></li>
</ul>
</li>
<li>
<p>✅ <strong>System Dependencies</strong>:</p>
<ul>
<li>Detects package manager (apt-get/yum/dnf)</li>
<li>Installs Python 3, pip, venv, OpenSSL</li>
<li>Installs MySQL/MariaDB server</li>
<li>Installs Redis server</li>
<li>Starts and enables MySQL and Redis services</li>
</ul>
</li>
<li>
<p>✅ <strong>Python Environment</strong>:</p>
<ul>
<li>Creates virtual environment at <code>$RemotePath/venv</code></li>
<li>Upgrades pip</li>
<li>Installs dependencies from all <code>requirements.txt</code> files:
<ul>
<li><code>main_server/requirements.txt</code></li>
<li><code>proxy/requirements.txt</code></li>
<li><code>worker/requirements.txt</code></li>
<li><code>portal/requirements.txt</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>✅ <strong>Database Setup</strong>:</p>
<ul>
<li>Creates database <code>message_system</code> if it doesn't exist</li>
<li>Creates user <code>systemuser@localhost</code> with password <code>YourStrongPassword123!</code></li>
<li>Grants all privileges on <code>message_system</code> database</li>
<li>Updates password if user already exists</li>
</ul>
</li>
<li>
<p>✅ <strong>Environment Configuration</strong>:</p>
<ul>
<li>Creates <code>.env</code> file at <code>$RemotePath/.env</code> with:
<ul>
<li>Database credentials (uses <code>YourStrongPassword123!</code>)</li>
<li>Redis configuration</li>
<li>JWT secrets</li>
<li>Admin credentials (<code>admin@example.com</code> / <code>AdminPass123!</code>)</li>
<li>Service endpoints</li>
<li>Worker configuration</li>
</ul>
</li>
<li><strong>Important</strong>: The script uses a hardcoded password <code>YourStrongPassword123!</code> for the database user</li>
</ul>
</li>
<li>
<p>✅ <strong>Database Migrations</strong>:</p>
<ul>
<li>Loads environment variables from <code>.env</code></li>
<li>Tests database connection</li>
<li>Runs <code>alembic upgrade head</code> to create schema</li>
</ul>
</li>
<li>
<p>✅ <strong>Certificate Generation</strong>:</p>
<ul>
<li>Generates CA certificate if missing</li>
<li>Generates server certificate for main_server</li>
<li>Generates proxy certificate</li>
<li>Generates worker certificate</li>
<li>Sets proper permissions (600 for keys, 644 for certs)</li>
</ul>
</li>
<li>
<p>✅ <strong>Encryption Key</strong>:</p>
<ul>
<li>Generates AES encryption key at <code>$RemotePath/main_server/secrets/encryption.key</code></li>
</ul>
</li>
<li>
<p>✅ <strong>Service User</strong>:</p>
<ul>
<li>Creates system user <code>messagebroker</code> (if not exists)</li>
<li>Sets ownership of <code>$RemotePath</code> to <code>messagebroker:messagebroker</code></li>
</ul>
</li>
<li>
<p>✅ <strong>Service Installation</strong>:</p>
<ul>
<li>Copies service files to <code>/etc/systemd/system/</code></li>
<li>Updates paths in service files to match <code>$RemotePath</code></li>
<li>Runs <code>systemctl daemon-reload</code></li>
<li>Enables services (but does NOT start them automatically)</li>
</ul>
</li>
<li>
<p>✅ <strong>Admin User Creation</strong>:</p>
<ul>
<li>Checks if admin user exists</li>
<li>Creates admin user <code>admin@example.com</code> with password <code>AdminPass123!</code> if missing</li>
</ul>
</li>
</ol>
<p><strong>Note</strong>: The script does NOT automatically start services. You must start them manually after deployment.</p>
<h3 id="step-5%3A-start-services-and-verify-deployment" tabindex="-1">Step 5: Start Services and Verify Deployment</h3>
<p><strong>Important</strong>: The deployment script does NOT start services automatically. You must start them:</p>
<pre class="hljs"><code><div><span class="hljs-comment"># SSH into server</span>
ssh -p 2222 root@173.32.115.223

<span class="hljs-comment"># Start all services</span>
<span class="hljs-built_in">sudo</span> systemctl start main_server proxy worker portal

<span class="hljs-comment"># Check service status</span>
systemctl status main_server proxy worker portal

<span class="hljs-comment"># Check listening ports</span>
ss -tlnp | grep -E <span class="hljs-string">':(8000|8001|8080)'</span>

<span class="hljs-comment"># Test health endpoints</span>
curl -k https://localhost:8000/health
curl -k https://localhost:8001/health
curl http://localhost:8080/health
</div></code></pre>
<p><strong>Note</strong>: If services fail to start, check the troubleshooting section below.</p>
<hr>
<h2 id="manual-deployment" tabindex="-1">Manual Deployment</h2>
<p>If you prefer manual deployment or need to customize the process:</p>
<h3 id="prerequisites%3A-connect-to-server" tabindex="-1">Prerequisites: Connect to Server</h3>
<p>Before starting manual deployment, you need to connect to your Linux server via SSH.</p>
<p><strong>SSH Login Commands:</strong></p>
<p><strong>From Windows PowerShell or Command Prompt:</strong></p>
<pre class="hljs"><code><div>ssh <span class="hljs-literal">-p</span> <span class="hljs-number">2222</span> root@<span class="hljs-number">173.32</span>.<span class="hljs-number">115.223</span>
</div></code></pre>
<p>When prompted, enter the password: <code>Abbas$12345</code></p>
<p><strong>Or using plink (PuTTY) with automatic password:</strong></p>
<pre class="hljs"><code><div>plink <span class="hljs-literal">-P</span> <span class="hljs-number">2222</span> <span class="hljs-literal">-ssh</span> <span class="hljs-literal">-pw</span> <span class="hljs-string">"Abbas`$12345"</span> root@<span class="hljs-number">173.32</span>.<span class="hljs-number">115.223</span>
</div></code></pre>
<p><strong>From Linux/Mac terminal:</strong></p>
<pre class="hljs"><code><div>ssh -p 2222 root@173.32.115.223
</div></code></pre>
<p>When prompted, enter the password: <code>Abbas$12345</code></p>
<p><strong>Note</strong>:</p>
<ul>
<li>Replace <code>173.32.115.223</code> with your server IP address</li>
<li>Replace <code>2222</code> with your SSH port if different</li>
<li>Replace <code>Abbas$12345</code> with your actual root password</li>
<li>The password contains special characters (<code>$</code>), so type it exactly as shown</li>
</ul>
<p><strong>After successful login</strong>, you'll see a prompt like:</p>
<pre class="hljs"><code><div>root@MsgBrocker:~#
</div></code></pre>
<p>You're now logged in as root and can proceed with the manual deployment steps below. Since you're logged in as <code>root</code>, you don't need to use <code>sudo</code> for any commands.</p>
<hr>
<h3 id="step-1%3A-install-system-dependencies-%E2%9C%85" tabindex="-1">Step 1: Install System Dependencies ✅</h3>
<p><strong>Status</strong>: All dependencies are installed and services are running.</p>
<p><strong>Copy and paste these commands (Ubuntu/Debian):</strong></p>
<pre class="hljs"><code><div>apt update &amp;&amp; apt upgrade -y
apt install -y python3 python3-pip python3-venv python3-dev build-essential libssl-dev libffi-dev
apt install -y mysql-server mysql-client default-libmysqlclient-dev
apt install -y redis-server
apt install -y openssl curl wget git
systemctl start mysql
systemctl <span class="hljs-built_in">enable</span> mysql
systemctl start redis-server
systemctl <span class="hljs-built_in">enable</span> redis-server
python3 --version
mysql --version
redis-cli --version
openssl version
</div></code></pre>
<p><strong>Copy and paste these commands (CentOS/RHEL/Rocky Linux):</strong></p>
<pre class="hljs"><code><div>yum update -y
yum install -y epel-release
yum install -y python3 python3-pip python3-devel gcc gcc-c++ make openssl-devel libffi-devel
yum install -y mariadb-server mariadb mysql-devel
yum install -y redis
yum install -y openssl curl wget git
systemctl start mariadb
systemctl <span class="hljs-built_in">enable</span> mariadb
systemctl start redis
systemctl <span class="hljs-built_in">enable</span> redis
python3 --version
mysql --version
redis-cli --version
openssl version
</div></code></pre>
<h3 id="step-2%3A-transfer-project-files-%E2%9C%85" tabindex="-1">Step 2: Transfer Project Files ✅</h3>
<p><strong>Status</strong>: Project files are already deployed at <code>/opt/message_broker</code>.</p>
<p><strong>Copy and paste these commands (From Windows PowerShell):</strong></p>
<p><strong>Option 1: Using pscp (PuTTY) with automatic password (Recommended):</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">Compress-Archive</span> <span class="hljs-literal">-Path</span> .\* <span class="hljs-literal">-DestinationPath</span> message_broker.zip <span class="hljs-literal">-Force</span>
pscp <span class="hljs-literal">-P</span> <span class="hljs-number">2222</span> <span class="hljs-literal">-pw</span> <span class="hljs-string">"Abbas`$12345"</span> message_broker.zip root@<span class="hljs-number">173.32</span>.<span class="hljs-number">115.223</span>:/tmp/
</div></code></pre>
<p><strong>Option 2: Using scp (will prompt for password):</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">Compress-Archive</span> <span class="hljs-literal">-Path</span> .\* <span class="hljs-literal">-DestinationPath</span> message_broker.zip <span class="hljs-literal">-Force</span>
scp <span class="hljs-literal">-P</span> <span class="hljs-number">2222</span> message_broker.zip root@<span class="hljs-number">173.32</span>.<span class="hljs-number">115.223</span>:/tmp/
<span class="hljs-comment"># When prompted, enter password: Abbas$12345</span>
</div></code></pre>
<p><strong>Note</strong>: Replace <code>Abbas$12345</code> with your actual password. The <code>$</code> character needs to be escaped as <code>`$</code> in PowerShell.</p>
<p><strong>Copy and paste these commands (From Linux/Mac):</strong></p>
<pre class="hljs"><code><div>tar -czf message_broker.tar.gz --exclude=<span class="hljs-string">'venv'</span> --exclude=<span class="hljs-string">'__pycache__'</span> --exclude=<span class="hljs-string">'*.pyc'</span> --exclude=<span class="hljs-string">'.git'</span> .
scp -P 2222 message_broker.tar.gz root@173.32.115.223:/tmp/
</div></code></pre>
<p><strong>Copy and paste these commands (On Server - Extract Files):</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">mkdir</span> -p /opt/message_broker
<span class="hljs-built_in">chown</span> <span class="hljs-variable">$USER</span>:<span class="hljs-variable">$USER</span> /opt/message_broker
<span class="hljs-built_in">cd</span> /opt/message_broker
unzip /tmp/message_broker.zip
<span class="hljs-comment"># OR if using tar.gz:</span>
<span class="hljs-comment"># tar -xzf /tmp/message_broker.tar.gz</span>
</div></code></pre>
<h3 id="step-3%3A-set-up-python-environment-%E2%9C%85" tabindex="-1">Step 3: Set Up Python Environment ✅</h3>
<p><strong>Status</strong>: Virtual environment exists and dependencies are installed.</p>
<p><strong>Copy and paste these commands:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /opt/message_broker
python3 -m venv venv
<span class="hljs-built_in">source</span> venv/bin/activate
pip install --upgrade pip
pip install -r main_server/requirements.txt
pip install -r proxy/requirements.txt
pip install -r worker/requirements.txt
pip install -r portal/requirements.txt
pip install itsdangerous
</div></code></pre>
<h3 id="step-4%3A-configure-mysql-database-%E2%9C%85" tabindex="-1">Step 4: Configure MySQL Database ✅</h3>
<p><strong>Status</strong>: Database <code>message_system</code> and user <code>systemuser@localhost</code> exist.</p>
<p><strong>Copy and paste these commands:</strong></p>
<pre class="hljs"><code><div>systemctl start mysql
systemctl <span class="hljs-built_in">enable</span> mysql
mysql -u root &lt;&lt;<span class="hljs-string">EOF
CREATE DATABASE IF NOT EXISTS message_system CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER IF NOT EXISTS 'systemuser'@'localhost' IDENTIFIED BY 'StrongPass123!';
GRANT ALL PRIVILEGES ON message_system.* TO 'systemuser'@'localhost';
FLUSH PRIVILEGES;
EOF</span>
</div></code></pre>
<p><strong>Important</strong>: Replace <code>StrongPass123!</code> with a strong password and remember it for the <code>.env</code> file.</p>
<h3 id="step-5%3A-configure-redis-%E2%9C%85" tabindex="-1">Step 5: Configure Redis ✅</h3>
<p><strong>Status</strong>: Redis server is running and accessible.</p>
<p><strong>Copy and paste these commands:</strong></p>
<pre class="hljs"><code><div>systemctl start redis-server
systemctl <span class="hljs-built_in">enable</span> redis-server
redis-cli ping
</div></code></pre>
<h3 id="step-6%3A-generate-ssl-certificates-%E2%9C%85" tabindex="-1">Step 6: Generate SSL Certificates ✅</h3>
<p><strong>Status</strong>: All SSL certificates (CA, server, proxy, worker) are generated and in place.</p>
<p><strong>Copy and paste these commands:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /opt/message_broker
<span class="hljs-built_in">mkdir</span> -p main_server/certs proxy/certs worker/certs
openssl genrsa -out main_server/ca.key 4096
openssl req -new -x509 -days 3650 -key main_server/ca.key -out main_server/certs/ca.crt -subj <span class="hljs-string">"/CN=MessageBroker-CA"</span>
<span class="hljs-built_in">cp</span> main_server/certs/ca.crt proxy/certs/ca.crt
<span class="hljs-built_in">cp</span> main_server/certs/ca.crt worker/certs/ca.crt
openssl genrsa -out main_server/certs/server.key 2048
openssl req -new -key main_server/certs/server.key -out main_server/certs/server.csr -subj <span class="hljs-string">"/CN=main-server"</span>
openssl x509 -req -days 365 -<span class="hljs-keyword">in</span> main_server/certs/server.csr -CA main_server/certs/ca.crt -CAkey main_server/ca.key -CAcreateserial -out main_server/certs/server.crt
openssl genrsa -out proxy/certs/proxy.key 2048
openssl req -new -key proxy/certs/proxy.key -out proxy/certs/proxy.csr -subj <span class="hljs-string">"/CN=proxy-server"</span>
openssl x509 -req -days 365 -<span class="hljs-keyword">in</span> proxy/certs/proxy.csr -CA main_server/certs/ca.crt -CAkey main_server/ca.key -CAcreateserial -out proxy/certs/proxy.crt
openssl genrsa -out worker/certs/worker.key 2048
openssl req -new -key worker/certs/worker.key -out worker/certs/worker.csr -subj <span class="hljs-string">"/CN=worker"</span>
openssl x509 -req -days 365 -<span class="hljs-keyword">in</span> worker/certs/worker.csr -CA main_server/certs/ca.crt -CAkey main_server/ca.key -CAcreateserial -out worker/certs/worker.crt
<span class="hljs-built_in">chmod</span> 600 main_server/ca.key
<span class="hljs-built_in">chmod</span> 600 main_server/certs/*.key
<span class="hljs-built_in">chmod</span> 600 proxy/certs/*.key
<span class="hljs-built_in">chmod</span> 600 worker/certs/*.key
<span class="hljs-built_in">chmod</span> 644 main_server/certs/*.crt
<span class="hljs-built_in">chmod</span> 644 proxy/certs/*.crt
<span class="hljs-built_in">chmod</span> 644 worker/certs/*.crt
</div></code></pre>
<h3 id="step-7%3A-configure-environment-variables-%E2%9C%85" tabindex="-1">Step 7: Configure Environment Variables ✅</h3>
<p><strong>Status</strong>: <code>.env</code> file exists with all required configuration variables.</p>
<p><strong>Copy and paste these commands:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /opt/message_broker
<span class="hljs-built_in">cp</span> env.template .<span class="hljs-built_in">env</span>
nano .<span class="hljs-built_in">env</span>
</div></code></pre>
<p><strong>Required Configuration:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Database Configuration</span>
DB_HOST=localhost
DB_PORT=3306
DB_NAME=message_system
DB_USER=systemuser
DB_PASSWORD=YourStrongPassword123!  <span class="hljs-comment"># Script uses this hardcoded password</span>

<span class="hljs-comment"># Redis Configuration</span>
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

<span class="hljs-comment"># Security - Encryption Key Path (Linux)</span>
ENCRYPTION_KEY_PATH=/opt/message_broker/main_server/secrets/encryption.key

<span class="hljs-comment"># JWT Configuration</span>
JWT_SECRET=SuperSecretJWTKey_ChangeInProduction
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=30

<span class="hljs-comment"># Admin Credentials (Portal)</span>
ADMIN_USER=admin@example.com
ADMIN_PASS=AdminPass123!

<span class="hljs-comment"># Service Endpoints</span>
PROXY_URL=https://localhost:8001
MAIN_SERVER_URL=https://localhost:8000
PORTAL_URL=http://localhost:8080

<span class="hljs-comment"># Worker Configuration</span>
WORKER_RETRY_INTERVAL=30
WORKER_MAX_ATTEMPTS=10000
WORKER_CONCURRENCY=4

<span class="hljs-comment"># Logging</span>
LOG_LEVEL=INFO
</div></code></pre>
<p><strong>Important</strong>:</p>
<ul>
<li>The automated script uses hardcoded <code>DB_PASSWORD=YourStrongPassword123!</code> - <strong>change this in production</strong></li>
<li>The automated script uses hardcoded <code>ADMIN_PASS=AdminPass123!</code> - <strong>change this in production</strong></li>
<li>Change <code>JWT_SECRET</code> to a strong random string in production (minimum 32 characters)</li>
<li>For manual deployment, use a strong password of your choice</li>
</ul>
<h3 id="step-8%3A-initialize-database-schema-%E2%9C%85" tabindex="-1">Step 8: Initialize Database Schema ✅</h3>
<p><strong>Status</strong>: Database migrations are at head (001), all tables exist (users, clients, messages, audit_log, alembic_version).</p>
<p><strong>Copy and paste these commands (run each line separately or as a block):</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /opt/message_broker
sed -i <span class="hljs-string">'s/\r$//'</span> .<span class="hljs-built_in">env</span>
<span class="hljs-built_in">export</span> $(<span class="hljs-built_in">cat</span> .<span class="hljs-built_in">env</span> | grep -v <span class="hljs-string">'^#'</span> | xargs)
<span class="hljs-built_in">echo</span> <span class="hljs-string">"DB_HOST value: '<span class="hljs-variable">$DB_HOST</span>'"</span>
<span class="hljs-built_in">source</span> venv/bin/activate
<span class="hljs-built_in">cd</span> main_server
alembic upgrade <span class="hljs-built_in">head</span>
</div></code></pre>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>sed -i 's/\r$//' .env</code> - Fixes Windows line endings (CRLF) if .env was transferred from Windows</li>
<li><code>export $(cat .env | grep -v '^#' | xargs)</code> - Loads environment variables from .env file</li>
<li><code>echo "DB_HOST value: '$DB_HOST'"</code> - Verifies DB_HOST doesn't have trailing \r</li>
<li><code>source venv/bin/activate</code> - Activates the Python virtual environment</li>
<li><code>cd main_server</code> - Changes to the main_server directory</li>
<li><code>alembic upgrade head</code> - Runs database migrations</li>
</ul>
<p><strong>Note</strong>: If you see an error like <code>Can't connect to MySQL server on 'localhost\r'</code>, it means the .env file has Windows line endings. The <code>sed -i 's/\r$//' .env</code> command above fixes this.</p>
<h3 id="step-9%3A-create-service-user-%E2%9C%85" tabindex="-1">Step 9: Create Service User ✅</h3>
<p><strong>Status</strong>: Service user <code>messagebroker</code> exists and owns <code>/opt/message_broker</code>.</p>
<p><strong>Copy and paste these commands:</strong></p>
<pre class="hljs"><code><div>useradd -r -s /bin/false -d /opt/message_broker messagebroker
<span class="hljs-built_in">chown</span> -R messagebroker:messagebroker /opt/message_broker
<span class="hljs-built_in">mkdir</span> -p /opt/message_broker/{main_server,proxy,worker,portal}/{logs,secrets}
<span class="hljs-built_in">chown</span> -R messagebroker:messagebroker /opt/message_broker/*/logs
<span class="hljs-built_in">chown</span> -R messagebroker:messagebroker /opt/message_broker/*/secrets
</div></code></pre>
<h3 id="step-10%3A-install-systemd-services-%E2%9C%85" tabindex="-1">Step 10: Install Systemd Services ✅</h3>
<p><strong>Status</strong>: All systemd services (main_server, proxy, worker, portal) are installed and enabled.</p>
<p><strong>Copy and paste these commands:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /opt/message_broker
<span class="hljs-built_in">cp</span> main_server/main_server.service /etc/systemd/system/
<span class="hljs-built_in">cp</span> proxy/proxy.service /etc/systemd/system/
<span class="hljs-built_in">cp</span> worker/worker.service /etc/systemd/system/
<span class="hljs-built_in">cp</span> portal/portal.service /etc/systemd/system/
systemctl daemon-reload
systemctl <span class="hljs-built_in">enable</span> main_server proxy worker portal
</div></code></pre>
<h3 id="step-11%3A-create-admin-user-%E2%9C%85" tabindex="-1">Step 11: Create Admin User ✅</h3>
<p><strong>Status</strong>: Admin user <code>admin@example.com</code> with role <code>admin</code> exists in the database.</p>
<p><strong>Copy and paste these commands:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /opt/message_broker/main_server
<span class="hljs-built_in">source</span> ../venv/bin/activate
<span class="hljs-comment"># Set DATABASE_URL with correct password (admin_cli.py reads from environment)</span>
<span class="hljs-comment"># Use single quotes to prevent bash from interpreting ! as history expansion</span>
<span class="hljs-built_in">export</span> DATABASE_URL=<span class="hljs-string">'mysql+pymysql://systemuser:YourStrongPassword123!@localhost:3306/message_system'</span>
python admin_cli.py user create admin@example.com --role admin --password AdminPass123!
</div></code></pre>
<p><strong>Note</strong>: Use <strong>single quotes</strong> (<code>'...'</code>) instead of double quotes (<code>"..."</code>) to prevent bash from interpreting <code>!</code> as history expansion.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>The <code>admin_cli.py</code> script reads <code>DATABASE_URL</code> from environment variables, so you must export it before running the command</li>
<li>Replace <code>YourStrongPassword123!</code> with your actual database password if different</li>
<li>If you see "User with email ... already exists", the admin user was already created</li>
</ul>
<p><strong>Note</strong>: The email is a positional argument (not <code>--email</code>). The correct syntax is:</p>
<ul>
<li><code>user create &lt;email&gt; --role &lt;role&gt; --password &lt;password&gt;</code></li>
</ul>
<h3 id="step-12%3A-start-services-%E2%9C%85" tabindex="-1">Step 12: Start Services ✅</h3>
<p><strong>Status</strong>: All services (main_server, proxy, worker, portal) are active and running.</p>
<p><strong>Copy and paste these commands:</strong></p>
<pre class="hljs"><code><div>systemctl start main_server proxy worker portal
systemctl status main_server proxy worker portal
systemctl is-active main_server proxy worker portal
ss -tlnp | grep -E <span class="hljs-string">':(8000|8001|8080)'</span>
curl -k https://localhost:8000/health
curl http://localhost:8080/health
</div></code></pre>
<p><strong>Important</strong>: The automated deployment script does NOT start services automatically. You must start them manually.</p>
<hr>
<h3 id="manual-deployment-summary-%E2%9C%85" tabindex="-1">Manual Deployment Summary ✅</h3>
<p><strong>All 12 steps completed successfully!</strong></p>
<table>
<thead>
<tr>
<th>Step</th>
<th>Status</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td>1. Install System Dependencies</td>
<td>✅</td>
<td>Python 3.11.2, MariaDB 10.11.14, Redis 7.0.15, OpenSSL 3.0.17</td>
</tr>
<tr>
<td>2. Transfer Project Files</td>
<td>✅</td>
<td>Files deployed at <code>/opt/message_broker</code></td>
</tr>
<tr>
<td>3. Set Up Python Environment</td>
<td>✅</td>
<td>Virtual environment created, all dependencies installed</td>
</tr>
<tr>
<td>4. Configure MySQL Database</td>
<td>✅</td>
<td>Database <code>message_system</code> and user <code>systemuser</code> exist</td>
</tr>
<tr>
<td>5. Configure Redis</td>
<td>✅</td>
<td>Redis server running and accessible</td>
</tr>
<tr>
<td>6. Generate SSL Certificates</td>
<td>✅</td>
<td>All certificates (CA, server, proxy, worker) generated</td>
</tr>
<tr>
<td>7. Configure Environment Variables</td>
<td>✅</td>
<td><code>.env</code> file configured with all required variables</td>
</tr>
<tr>
<td>8. Initialize Database Schema</td>
<td>✅</td>
<td>Migrations at head, all tables created</td>
</tr>
<tr>
<td>9. Create Service User</td>
<td>✅</td>
<td>User <code>messagebroker</code> exists with proper ownership</td>
</tr>
<tr>
<td>10. Install Systemd Services</td>
<td>✅</td>
<td>All services installed and enabled</td>
</tr>
<tr>
<td>11. Create Admin User</td>
<td>✅</td>
<td>Admin user <code>admin@example.com</code> exists</td>
</tr>
<tr>
<td>12. Start Services</td>
<td>✅</td>
<td>All services active and running</td>
</tr>
</tbody>
</table>
<p><strong>Final Verification:</strong></p>
<ul>
<li>✅ All ports listening: 8000 (main_server), 8001 (proxy), 8080 (portal)</li>
<li>✅ Health endpoints responding: Main Server and Portal both healthy</li>
<li>✅ All services running: main_server, proxy, worker, portal</li>
</ul>
<p><strong>System Status</strong>: 🟢 <strong>FULLY OPERATIONAL</strong></p>
<hr>
<h2 id="configuration" tabindex="-1">Configuration</h2>
<h3 id="environment-variables" tabindex="-1">Environment Variables</h3>
<p>The <code>.env</code> file contains all configuration. Key variables:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DB_HOST</code></td>
<td>MySQL host</td>
<td>localhost</td>
</tr>
<tr>
<td><code>DB_PORT</code></td>
<td>MySQL port</td>
<td>3306</td>
</tr>
<tr>
<td><code>DB_NAME</code></td>
<td>Database name</td>
<td>message_system</td>
</tr>
<tr>
<td><code>DB_USER</code></td>
<td>Database user</td>
<td>systemuser</td>
</tr>
<tr>
<td><code>DB_PASSWORD</code></td>
<td>Database password</td>
<td><strong>Required</strong></td>
</tr>
<tr>
<td><code>REDIS_HOST</code></td>
<td>Redis host</td>
<td>localhost</td>
</tr>
<tr>
<td><code>REDIS_PORT</code></td>
<td>Redis port</td>
<td>6379</td>
</tr>
<tr>
<td><code>JWT_SECRET</code></td>
<td>JWT signing key</td>
<td><strong>Change in production</strong></td>
</tr>
<tr>
<td><code>ENCRYPTION_KEY_PATH</code></td>
<td>AES encryption key path</td>
<td>/opt/message_broker/main_server/secrets/encryption.key</td>
</tr>
<tr>
<td><code>LOG_LEVEL</code></td>
<td>Logging level</td>
<td>INFO</td>
</tr>
</tbody>
</table>
<h3 id="service-configuration-files" tabindex="-1">Service Configuration Files</h3>
<p>Service-specific configurations are in:</p>
<ul>
<li><code>main_server/main_server.service</code> - Main server systemd service</li>
<li><code>proxy/proxy.service</code> - Proxy server systemd service</li>
<li><code>worker/worker.service</code> - Worker systemd service</li>
<li><code>portal/portal.service</code> - Portal systemd service</li>
</ul>
<p><strong>Important Service File Settings:</strong></p>
<ul>
<li><code>EnvironmentFile=-/opt/message_broker/.env</code> - Loads environment variables</li>
<li><code>Environment="PYTHONPATH=/opt/message_broker"</code> - Sets Python path</li>
<li><code>WorkingDirectory</code> - Service working directory</li>
<li><code>User=messagebroker</code> - Service runs as non-root user</li>
</ul>
<h3 id="firewall-configuration" tabindex="-1">Firewall Configuration</h3>
<p><strong>Open Required Ports:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Ubuntu/Debian (UFW)</span>
<span class="hljs-built_in">sudo</span> ufw allow 8000/tcp
<span class="hljs-built_in">sudo</span> ufw allow 8001/tcp
<span class="hljs-built_in">sudo</span> ufw allow 8080/tcp
<span class="hljs-built_in">sudo</span> ufw reload

<span class="hljs-comment"># CentOS/RHEL (firewalld)</span>
<span class="hljs-built_in">sudo</span> firewall-cmd --permanent --add-port=8000/tcp
<span class="hljs-built_in">sudo</span> firewall-cmd --permanent --add-port=8001/tcp
<span class="hljs-built_in">sudo</span> firewall-cmd --permanent --add-port=8080/tcp
<span class="hljs-built_in">sudo</span> firewall-cmd --reload

<span class="hljs-comment"># Or using iptables</span>
<span class="hljs-built_in">sudo</span> iptables -A INPUT -p tcp --dport 8000 -j ACCEPT
<span class="hljs-built_in">sudo</span> iptables -A INPUT -p tcp --dport 8001 -j ACCEPT
<span class="hljs-built_in">sudo</span> iptables -A INPUT -p tcp --dport 8080 -j ACCEPT
</div></code></pre>
<p><strong>Note</strong>: If using a cloud provider (AWS, Azure, GCP), also configure Security Groups/Network Security Groups to allow these ports.</p>
<hr>
<h2 id="service-management" tabindex="-1">Service Management</h2>
<h3 id="start-services" tabindex="-1">Start Services</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Start all services</span>
<span class="hljs-built_in">sudo</span> systemctl start main_server proxy worker portal

<span class="hljs-comment"># Start individual service</span>
<span class="hljs-built_in">sudo</span> systemctl start main_server
</div></code></pre>
<h3 id="stop-services" tabindex="-1">Stop Services</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Stop all services</span>
<span class="hljs-built_in">sudo</span> systemctl stop main_server proxy worker portal

<span class="hljs-comment"># Stop individual service</span>
<span class="hljs-built_in">sudo</span> systemctl stop main_server
</div></code></pre>
<h3 id="restart-services" tabindex="-1">Restart Services</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Restart all services</span>
<span class="hljs-built_in">sudo</span> systemctl restart main_server proxy worker portal

<span class="hljs-comment"># Restart individual service</span>
<span class="hljs-built_in">sudo</span> systemctl restart main_server
</div></code></pre>
<h3 id="check-service-status" tabindex="-1">Check Service Status</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Check all services</span>
<span class="hljs-built_in">sudo</span> systemctl status main_server proxy worker portal

<span class="hljs-comment"># Check individual service</span>
<span class="hljs-built_in">sudo</span> systemctl status main_server

<span class="hljs-comment"># Check if services are active</span>
<span class="hljs-built_in">sudo</span> systemctl is-active main_server proxy worker portal
</div></code></pre>
<h3 id="view-logs" tabindex="-1">View Logs</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># View logs for all services</span>
<span class="hljs-built_in">sudo</span> journalctl -u main_server -u proxy -u worker -u portal -f

<span class="hljs-comment"># View logs for specific service</span>
<span class="hljs-built_in">sudo</span> journalctl -u main_server -f

<span class="hljs-comment"># View last 100 lines</span>
<span class="hljs-built_in">sudo</span> journalctl -u main_server -n 100

<span class="hljs-comment"># View logs since today</span>
<span class="hljs-built_in">sudo</span> journalctl -u main_server --since today
</div></code></pre>
<h3 id="enable%2Fdisable-auto-start" tabindex="-1">Enable/Disable Auto-Start</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Enable services to start on boot</span>
<span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> main_server proxy worker portal

<span class="hljs-comment"># Disable auto-start</span>
<span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">disable</span> main_server proxy worker portal
</div></code></pre>
<hr>
<h2 id="verification-and-testing" tabindex="-1">Verification and Testing</h2>
<h3 id="1.-check-service-status" tabindex="-1">1. Check Service Status</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># All services should show "active (running)"</span>
<span class="hljs-built_in">sudo</span> systemctl status main_server proxy worker portal
</div></code></pre>
<h3 id="2.-check-listening-ports" tabindex="-1">2. Check Listening Ports</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Should show ports 8000, 8001, and 8080 listening</span>
ss -tlnp | grep -E <span class="hljs-string">':(8000|8001|8080)'</span>
</div></code></pre>
<h3 id="3.-test-health-endpoints" tabindex="-1">3. Test Health Endpoints</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Main Server health check</span>
curl -k https://localhost:8000/health
<span class="hljs-comment"># Expected: {"status":"healthy","timestamp":"...","components":{"database":"healthy","encryption":"healthy"}}</span>

<span class="hljs-comment"># Portal health check</span>
curl http://localhost:8080/health
<span class="hljs-comment"># Expected: {"status":"healthy","timestamp":"...","service":"portal"}</span>

<span class="hljs-comment"># Proxy health check (may return 404, which is normal)</span>
curl -k https://localhost:8001/health
</div></code></pre>
<h3 id="4.-test-api-endpoints" tabindex="-1">4. Test API Endpoints</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Main Server API documentation</span>
curl -k https://localhost:8000/docs

<span class="hljs-comment"># Portal login page</span>
curl http://localhost:8080/
</div></code></pre>
<h3 id="5.-test-database-connection" tabindex="-1">5. Test Database Connection</h3>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /opt/message_broker/main_server
<span class="hljs-built_in">source</span> ../venv/bin/activate
<span class="hljs-built_in">export</span> $(<span class="hljs-built_in">cat</span> ../.env | grep -v <span class="hljs-string">'^#'</span> | xargs)

<span class="hljs-comment"># Test connection</span>
python -c <span class="hljs-string">"from database import get_db; next(get_db())"</span>
<span class="hljs-comment"># Should return without errors</span>
</div></code></pre>
<h3 id="6.-test-redis-connection" tabindex="-1">6. Test Redis Connection</h3>
<pre class="hljs"><code><div>redis-cli ping
<span class="hljs-comment"># Should return: PONG</span>
</div></code></pre>
<h3 id="7.-access-web-portal" tabindex="-1">7. Access Web Portal</h3>
<p>Open in browser:</p>
<ul>
<li><strong>Local</strong>: <code>http://localhost:8080</code></li>
<li><strong>Remote</strong>: <code>http://YOUR_SERVER_IP:8080</code></li>
</ul>
<p><strong>Default Admin Credentials:</strong></p>
<ul>
<li>Email: <code>admin@example.com</code></li>
<li>Password: <code>AdminPass123!</code> (or as set in <code>.env</code>)</li>
</ul>
<p><strong>Important</strong>: Change default admin password after first login!</p>
<hr>
<h2 id="troubleshooting" tabindex="-1">Troubleshooting</h2>
<h3 id="service-won't-start" tabindex="-1">Service Won't Start</h3>
<p><strong>Problem</strong>: Service fails to start</p>
<p><strong>Solutions</strong>:</p>
<ol>
<li>
<p><strong>Check service logs:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> journalctl -u main_server -n 50
</div></code></pre>
</li>
<li>
<p><strong>Check environment variables:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> systemctl show main_server | grep EnvironmentFile
</div></code></pre>
</li>
<li>
<p><strong>Verify .env file exists:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">ls</span> -la /opt/message_broker/.env
</div></code></pre>
</li>
<li>
<p><strong>Check Python path:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> -u messagebroker /opt/message_broker/venv/bin/python --version
</div></code></pre>
</li>
<li>
<p><strong>Verify certificates exist:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">ls</span> -la /opt/message_broker/main_server/certs/
</div></code></pre>
</li>
</ol>
<h3 id="database-connection-error" tabindex="-1">Database Connection Error</h3>
<p><strong>Problem</strong>: <code>Access denied for user 'systemuser'@'localhost'</code></p>
<p><strong>Solutions</strong>:</p>
<ol>
<li>
<p><strong>Verify password in .env matches MySQL:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Check .env</span>
grep DB_PASSWORD /opt/message_broker/.env

<span class="hljs-comment"># Test MySQL connection</span>
mysql -u systemuser -p
</div></code></pre>
</li>
<li>
<p><strong>Update MySQL password:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> mysql -u root -p
ALTER USER <span class="hljs-string">'systemuser'</span>@<span class="hljs-string">'localhost'</span> IDENTIFIED BY <span class="hljs-string">'YourNewPassword'</span>;
FLUSH PRIVILEGES;
</div></code></pre>
</li>
<li>
<p><strong>Update .env file:</strong></p>
<pre class="hljs"><code><div>nano /opt/message_broker/.env
<span class="hljs-comment"># Update DB_PASSWORD</span>
</div></code></pre>
</li>
<li>
<p><strong>Restart services:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> systemctl restart main_server worker
</div></code></pre>
</li>
</ol>
<h3 id="module-not-found-errors" tabindex="-1">Module Not Found Errors</h3>
<p><strong>Problem</strong>: <code>ModuleNotFoundError: No module named 'X'</code></p>
<p><strong>Solutions</strong>:</p>
<ol>
<li>
<p><strong>Reinstall dependencies:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /opt/message_broker
<span class="hljs-built_in">source</span> venv/bin/activate
pip install -r main_server/requirements.txt
pip install -r proxy/requirements.txt
pip install -r worker/requirements.txt
pip install -r portal/requirements.txt
</div></code></pre>
</li>
<li>
<p><strong>Check PYTHONPATH in service file:</strong></p>
<pre class="hljs"><code><div>grep PYTHONPATH /etc/systemd/system/main_server.service
<span class="hljs-comment"># Should show: Environment="PYTHONPATH=/opt/message_broker"</span>
</div></code></pre>
</li>
<li>
<p><strong>Install missing package:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">source</span> venv/bin/activate
pip install missing-package-name
</div></code></pre>
</li>
</ol>
<h3 id="port-already-in-use" tabindex="-1">Port Already in Use</h3>
<p><strong>Problem</strong>: <code>Address already in use</code></p>
<p><strong>Solutions</strong>:</p>
<ol>
<li>
<p><strong>Find process using port:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> lsof -i :8000
<span class="hljs-comment"># or</span>
<span class="hljs-built_in">sudo</span> ss -tlnp | grep 8000
</div></code></pre>
</li>
<li>
<p><strong>Kill process:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">kill</span> -9 &lt;PID&gt;
</div></code></pre>
</li>
<li>
<p><strong>Restart service:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> systemctl restart main_server
</div></code></pre>
</li>
</ol>
<h3 id="certificate-errors" tabindex="-1">Certificate Errors</h3>
<p><strong>Problem</strong>: SSL/TLS certificate errors</p>
<p><strong>Solutions</strong>:</p>
<ol>
<li>
<p><strong>Verify certificates exist:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">ls</span> -la /opt/message_broker/main_server/certs/
</div></code></pre>
</li>
<li>
<p><strong>Regenerate certificates:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Follow Step 6 in Manual Deployment</span>
</div></code></pre>
</li>
<li>
<p><strong>Check certificate permissions:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chmod</span> 600 /opt/message_broker/*/certs/*.key
<span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chmod</span> 644 /opt/message_broker/*/certs/*.crt
</div></code></pre>
</li>
</ol>
<h3 id="proxy-service-stuck-in-%22activating%22" tabindex="-1">Proxy Service Stuck in "Activating"</h3>
<p><strong>Problem</strong>: Proxy service shows "activating" but ports are listening</p>
<p><strong>Solutions</strong>:</p>
<ol>
<li>
<p><strong>Change service type from <code>notify</code> to <code>simple</code>:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> sed -i <span class="hljs-string">'s/Type=notify/Type=simple/'</span> /etc/systemd/system/proxy.service
<span class="hljs-built_in">sudo</span> systemctl daemon-reload
<span class="hljs-built_in">sudo</span> systemctl restart proxy
</div></code></pre>
</li>
<li>
<p><strong>Check if proxy is actually running:</strong></p>
<pre class="hljs"><code><div>ps aux | grep uvicorn
ss -tlnp | grep 8001
</div></code></pre>
</li>
</ol>
<h3 id="cannot-access-portal-from-browser" tabindex="-1">Cannot Access Portal from Browser</h3>
<p><strong>Problem</strong>: Portal not accessible from external network</p>
<p><strong>Solutions</strong>:</p>
<ol>
<li>
<p><strong>Check firewall:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> ufw status
<span class="hljs-comment"># or</span>
<span class="hljs-built_in">sudo</span> firewall-cmd --list-ports
</div></code></pre>
</li>
<li>
<p><strong>Open port 8080:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> ufw allow 8080/tcp
<span class="hljs-comment"># or</span>
<span class="hljs-built_in">sudo</span> firewall-cmd --permanent --add-port=8080/tcp
<span class="hljs-built_in">sudo</span> firewall-cmd --reload
</div></code></pre>
</li>
<li>
<p><strong>Check cloud provider firewall:</strong></p>
<ul>
<li>AWS: Security Groups</li>
<li>Azure: Network Security Groups</li>
<li>GCP: Firewall Rules</li>
</ul>
</li>
<li>
<p><strong>Verify portal is listening on 0.0.0.0:</strong></p>
<pre class="hljs"><code><div>ss -tlnp | grep 8080
<span class="hljs-comment"># Should show: 0.0.0.0:8080</span>
</div></code></pre>
</li>
</ol>
<h3 id="worker-not-processing-messages" tabindex="-1">Worker Not Processing Messages</h3>
<p><strong>Problem</strong>: Messages stuck in queue</p>
<p><strong>Solutions</strong>:</p>
<ol>
<li>
<p><strong>Check worker logs:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> journalctl -u worker -f
</div></code></pre>
</li>
<li>
<p><strong>Verify Redis connection:</strong></p>
<pre class="hljs"><code><div>redis-cli ping
</div></code></pre>
</li>
<li>
<p><strong>Check queue:</strong></p>
<pre class="hljs"><code><div>redis-cli
&gt; KEYS *
&gt; LLEN message_queue
</div></code></pre>
</li>
<li>
<p><strong>Restart worker:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> systemctl restart worker
</div></code></pre>
</li>
</ol>
<hr>
<h2 id="post-deployment-tasks" tabindex="-1">Post-Deployment Tasks</h2>
<h3 id="1.-change-default-passwords" tabindex="-1">1. Change Default Passwords</h3>
<p><strong>Change Admin Password:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /opt/message_broker/main_server
<span class="hljs-built_in">source</span> ../venv/bin/activate
<span class="hljs-built_in">export</span> $(<span class="hljs-built_in">cat</span> ../.env | grep -v <span class="hljs-string">'^#'</span> | xargs)

python admin_cli.py user update --email admin@example.com --password NewStrongPassword
</div></code></pre>
<p><strong>Change Database Password:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Update MySQL</span>
<span class="hljs-built_in">sudo</span> mysql -u root -p
ALTER USER <span class="hljs-string">'systemuser'</span>@<span class="hljs-string">'localhost'</span> IDENTIFIED BY <span class="hljs-string">'NewStrongPassword'</span>;
FLUSH PRIVILEGES;

<span class="hljs-comment"># Update .env</span>
nano /opt/message_broker/.env
<span class="hljs-comment"># Update DB_PASSWORD</span>

<span class="hljs-comment"># Restart services</span>
<span class="hljs-built_in">sudo</span> systemctl restart main_server worker
</div></code></pre>
<h3 id="2.-configure-production-settings" tabindex="-1">2. Configure Production Settings</h3>
<p><strong>Update .env for Production:</strong></p>
<pre class="hljs"><code><div>nano /opt/message_broker/.env
</div></code></pre>
<p><strong>Important changes:</strong></p>
<ul>
<li>Set strong <code>JWT_SECRET</code></li>
<li>Set strong <code>DB_PASSWORD</code></li>
<li>Set strong <code>ADMIN_PASS</code></li>
<li>Update <code>LOG_LEVEL</code> to <code>WARNING</code> or <code>ERROR</code> for production</li>
<li>Configure proper <code>ENCRYPTION_KEY_PATH</code></li>
</ul>
<h3 id="3.-set-up-log-rotation" tabindex="-1">3. Set Up Log Rotation</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Create logrotate configuration</span>
<span class="hljs-built_in">sudo</span> nano /etc/logrotate.d/message_broker
</div></code></pre>
<p>Add:</p>
<pre class="hljs"><code><div>/opt/message_broker/*/logs/*.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0640 messagebroker messagebroker
}
</div></code></pre>
<h3 id="4.-set-up-monitoring-(optional)" tabindex="-1">4. Set Up Monitoring (Optional)</h3>
<p><strong>Install Prometheus:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Download and install Prometheus</span>
wget https://github.com/prometheus/prometheus/releases/download/v2.45.0/prometheus-2.45.0.linux-amd64.tar.gz
tar xzf prometheus-*.tar.gz
<span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mv</span> prometheus-*.linux-amd64 /opt/prometheus
</div></code></pre>
<p><strong>Configure monitoring endpoints</strong> (if implemented in services)</p>
<h3 id="5.-set-up-backups" tabindex="-1">5. Set Up Backups</h3>
<p><strong>Database Backup Script:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> nano /opt/message_broker/backup_db.sh
</div></code></pre>
<p>Add:</p>
<pre class="hljs"><code><div><span class="hljs-meta">#!/bin/bash</span>
BACKUP_DIR=<span class="hljs-string">"/opt/message_broker/backups"</span>
DATE=$(<span class="hljs-built_in">date</span> +%Y%m%d_%H%M%S)
<span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$BACKUP_DIR</span>

mysqldump -u systemuser -p<span class="hljs-string">'YourPassword'</span> message_system &gt; <span class="hljs-variable">$BACKUP_DIR</span>/message_system_<span class="hljs-variable">$DATE</span>.sql
gzip <span class="hljs-variable">$BACKUP_DIR</span>/message_system_<span class="hljs-variable">$DATE</span>.sql

<span class="hljs-comment"># Keep only last 7 days</span>
find <span class="hljs-variable">$BACKUP_DIR</span> -name <span class="hljs-string">"*.sql.gz"</span> -mtime +7 -delete
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-built_in">chmod</span> +x /opt/message_broker/backup_db.sh

<span class="hljs-comment"># Add to crontab (daily at 2 AM)</span>
<span class="hljs-built_in">sudo</span> crontab -e
<span class="hljs-comment"># Add: 0 2 * * * /opt/message_broker/backup_db.sh</span>
</div></code></pre>
<h3 id="6.-configure-ssl%2Ftls-for-portal-(optional)" tabindex="-1">6. Configure SSL/TLS for Portal (Optional)</h3>
<p>For production, consider setting up HTTPS for the portal:</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Install certbot</span>
<span class="hljs-built_in">sudo</span> apt install certbot python3-certbot-nginx

<span class="hljs-comment"># Generate certificate (if using nginx as reverse proxy)</span>
<span class="hljs-built_in">sudo</span> certbot --nginx -d your-domain.com
</div></code></pre>
<hr>
<h2 id="maintenance-and-updates" tabindex="-1">Maintenance and Updates</h2>
<h3 id="updating-the-application" tabindex="-1">Updating the Application</h3>
<ol>
<li>
<p><strong>Backup database:</strong></p>
<pre class="hljs"><code><div>/opt/message_broker/backup_db.sh
</div></code></pre>
</li>
<li>
<p><strong>Stop services:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> systemctl stop main_server proxy worker portal
</div></code></pre>
</li>
<li>
<p><strong>Update code:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /opt/message_broker
git pull
<span class="hljs-comment"># or transfer new files</span>
</div></code></pre>
</li>
<li>
<p><strong>Update dependencies:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">source</span> venv/bin/activate
pip install -r main_server/requirements.txt
pip install -r proxy/requirements.txt
pip install -r worker/requirements.txt
pip install -r portal/requirements.txt
</div></code></pre>
</li>
<li>
<p><strong>Run migrations:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> main_server
<span class="hljs-built_in">export</span> $(<span class="hljs-built_in">cat</span> ../.env | grep -v <span class="hljs-string">'^#'</span> | xargs)
alembic upgrade <span class="hljs-built_in">head</span>
</div></code></pre>
</li>
<li>
<p><strong>Restart services:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> systemctl start main_server proxy worker portal
</div></code></pre>
</li>
</ol>
<h3 id="database-migrations" tabindex="-1">Database Migrations</h3>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /opt/message_broker/main_server
<span class="hljs-built_in">source</span> ../venv/bin/activate
<span class="hljs-built_in">export</span> $(<span class="hljs-built_in">cat</span> ../.env | grep -v <span class="hljs-string">'^#'</span> | xargs)

<span class="hljs-comment"># Check current version</span>
alembic current

<span class="hljs-comment"># Upgrade to latest</span>
alembic upgrade <span class="hljs-built_in">head</span>

<span class="hljs-comment"># Create new migration</span>
alembic revision --autogenerate -m <span class="hljs-string">"Description of changes"</span>
</div></code></pre>
<h3 id="viewing-logs" tabindex="-1">Viewing Logs</h3>
<p><strong>Real-time logs:</strong></p>
<pre class="hljs"><code><div><span class="hljs-built_in">sudo</span> journalctl -u main_server -f
</div></code></pre>
<p><strong>Filtered logs:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Errors only</span>
<span class="hljs-built_in">sudo</span> journalctl -u main_server -p err

<span class="hljs-comment"># Since specific time</span>
<span class="hljs-built_in">sudo</span> journalctl -u main_server --since <span class="hljs-string">"2025-11-24 10:00:00"</span>
</div></code></pre>
<hr>
<h2 id="service-urls" tabindex="-1">Service URLs</h2>
<p>After successful deployment:</p>
<ul>
<li><strong>Main Server API</strong>: <code>https://YOUR_SERVER_IP:8000/docs</code></li>
<li><strong>Proxy API</strong>: <code>https://YOUR_SERVER_IP:8001/api/v1/docs</code></li>
<li><strong>Web Portal</strong>: <code>http://YOUR_SERVER_IP:8080</code></li>
</ul>
<p><strong>Default Admin Login (Created by Script):</strong></p>
<ul>
<li>Email: <code>admin@example.com</code></li>
<li>Password: <code>AdminPass123!</code> (hardcoded in script - <strong>change immediately after first login</strong>)</li>
</ul>
<p><strong>Default Database Password (Set by Script):</strong></p>
<ul>
<li>Database User: <code>systemuser@localhost</code></li>
<li>Password: <code>YourStrongPassword123!</code> (hardcoded in script - <strong>change in production</strong>)</li>
</ul>
<hr>
<h2 id="support-and-resources" tabindex="-1">Support and Resources</h2>
<ul>
<li><strong>Logs Location</strong>: <code>/opt/message_broker/*/logs/</code></li>
<li><strong>Configuration</strong>: <code>/opt/message_broker/.env</code></li>
<li><strong>Service Files</strong>: <code>/etc/systemd/system/*.service</code></li>
<li><strong>Database</strong>: MySQL <code>message_system</code> database</li>
<li><strong>Certificates</strong>: <code>/opt/message_broker/*/certs/</code></li>
</ul>
<hr>
<h2 id="quick-reference-commands" tabindex="-1">Quick Reference Commands</h2>
<pre class="hljs"><code><div><span class="hljs-comment"># Start all services</span>
<span class="hljs-built_in">sudo</span> systemctl start main_server proxy worker portal

<span class="hljs-comment"># Stop all services</span>
<span class="hljs-built_in">sudo</span> systemctl stop main_server proxy worker portal

<span class="hljs-comment"># Restart all services</span>
<span class="hljs-built_in">sudo</span> systemctl restart main_server proxy worker portal

<span class="hljs-comment"># Check status</span>
<span class="hljs-built_in">sudo</span> systemctl status main_server proxy worker portal

<span class="hljs-comment"># View logs</span>
<span class="hljs-built_in">sudo</span> journalctl -u main_server -f

<span class="hljs-comment"># Test health</span>
curl -k https://localhost:8000/health
curl http://localhost:8080/health

<span class="hljs-comment"># Check ports</span>
ss -tlnp | grep -E <span class="hljs-string">':(8000|8001|8080)'</span>
</div></code></pre>
<hr>
<p><strong>Document Version</strong>: 2.0.0<br>
<strong>Last Updated</strong>: November 2025<br>
<strong>Maintained By</strong>: Message Broker Development Team</p>

    </div>


</body></html>